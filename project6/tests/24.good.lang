/*
After execute a = c.BtoA(b); both pointers in "b" and "a" are pointing to the address of object "b".

But when you what to access member "x", they applied different rules:

1) If you access "b.x" you should additionally add a "superclass offset" (total_members_in _all_superclass * 4) since classB is inherited  from classA.

2) If you access "a.x" you can just use a local offset within classA.

That is how casting works in 24.good.lang.
*/
classA {
     integer x;

     classA(integer val) -> none {
         x = val;
     }

     double() -> none {
         x = x * 2;
     }
}

classB extends classA {
    integer x;

    classB(integer val1, integer val2) -> none {
        classA(val1);
	x = val2;
    }

    double() -> none {
        x = x * 2 - 1;
    }
}

CastClass {

    BtoA(classB b) -> classA {
        return b;
    }

}

Main {

     main() -> none {
	    classB b;
	    classA a;
	    CastClass c;

	    b = new classB(4, 5);
	    a = c.BtoA(b);

	    print a.x;
	    print b.x;

	    a.double();

	    print a.x;
	    print b.x;

	    b.double();

	    print a.x;
	    print b.x;
     }

}
